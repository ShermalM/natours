{"mappings":"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","sources":["public/js/mapbox.js","public/js/alert.js","public/js/login.js","public/js/updateSettings.js","public/js/stripe.js","public/js/index.js"],"sourcesContent":["export const displayMap = (locations) => {\r\n    mapboxgl.accessToken = 'pk.eyJ1Ijoic2hlcm11aCIsImEiOiJjbDYwem9mdm4wNG1yM2ZwODVobHZoN215In0.p4kiMgc1Hda0tDMLqyy-qQ';\r\n    var map = new mapboxgl.Map({\r\n        container: 'map',\r\n        style: 'mapbox://styles/shermuh/cl627cd21002714vudr5brzz8',\r\n        scrollZoom: false\r\n        // center: [-118.113491, 34.111745],\r\n        // zoom: 4,\r\n        // interactive: false\r\n    });\r\n\r\n    const bounds = new mapboxgl.LngLatBounds();\r\n\r\n    locations.forEach(loc => {\r\n        // Create marker\r\n        const el = document.createElement('div');\r\n        el.className = 'marker';\r\n\r\n        // Add marker\r\n        new mapboxgl.Marker({\r\n            element: el,\r\n            anchor: 'bottom'\r\n        })\r\n        .setLngLat(loc.coordinates)\r\n        .addTo(map);\r\n\r\n        // Add popup\r\n        new mapboxgl.Popup({\r\n            offset: 30\r\n        })\r\n        .setLngLat(loc.coordinates)\r\n        .setHTML(`<p>Day ${loc.day}: ${loc.description}</p>`)\r\n        .addTo(map);\r\n\r\n        // Extend map bounds to include current location\r\n        bounds.extend(loc.coordinates);\r\n    });\r\n\r\n    map.fitBounds(bounds, {\r\n        padding: {\r\n            top: 200,\r\n            bottom: 150,\r\n            left: 100,\r\n            right: 100\r\n        }\r\n    });\r\n};\r\n\r\n","export const hideAlert = () => {\r\n    const el = document.querySelector('.alert');\r\n    if(el) el.parentElement.removeChild(el);\r\n};\r\n\r\n// type is either 'success' or 'error'\r\nexport const showAlert = (type, message, time = 7) => {\r\n    hideAlert();\r\n    const markup = `<div class=\"alert alert--${type}\">${message}</div>`;\r\n    document.querySelector('body').insertAdjacentHTML('afterbegin', markup);\r\n    window.setTimeout(hideAlert, time * 1000);\r\n};","import axios from 'axios';\r\nimport { showAlert } from './alert';\r\n\r\nexport const login = async (email, password) => {\r\n    try{\r\n        const result = await axios({\r\n            method: 'POST',\r\n            url: '/api/v1/users/login',\r\n            data: {\r\n                email,\r\n                password\r\n            }\r\n        });\r\n\r\n        if(result.data.status === 'success'){\r\n            showAlert('success','Logged in successfully!');\r\n            window.setTimeout(()=> {\r\n                location.assign('/');\r\n            }, 1500);\r\n        }\r\n    } catch(err){\r\n        showAlert('error', err.response.data.message);\r\n    }\r\n};\r\n\r\nexport const logout = async () => {\r\n    try{\r\n        console.log('entered logout function');\r\n        const result = await axios({\r\n            method: 'GET',\r\n            url: '/api/v1/users/logout'\r\n        });\r\n        if(result.data.status === 'success') location.assign('/');     // true will force a reload from the server and not from browser cache\r\n    } catch(err){\r\n        showAlert('error', 'Error logging out! Try again.')\r\n    }\r\n};","import axios from 'axios';\r\nimport { showAlert } from './alert';\r\n\r\n// type is either 'password' or 'data'\r\nexport const updateSettings = async (data, type) => {\r\n    console.log('entered function');\r\n    try{\r\n        const url = type === 'password' ? 'updateMyPassword' : 'updateMe';\r\n\r\n        console.log(data);\r\n\r\n        const result = await axios({\r\n            method: 'PATCH',\r\n            url: `/api/v1/users/${url}`,\r\n            data\r\n        });\r\n\r\n        if(result.data.status === 'success'){\r\n            showAlert('success',`${type.toUpperCase()} updated successfully!`);\r\n        } \r\n    } catch(err){\r\n        showAlert('error', err.response.data.message);\r\n    }\r\n};","import axios from 'axios';\r\nimport { showAlert } from './alert';\r\n\r\nexport const bookTour = async tourID => {\r\n    try{\r\n        const stripe = Stripe('pk_test_51LQYhdCt7FQuxYr5qfe0kBXNn8c7KgeS3w8ml9ChiFlrmDWnqZM1Yt23SvpVpkSrXHhXwnhutXrSgwmblFeVm3dF00Bu7pkN2E');\r\n        // 1) Get checkout session from API endpoint\r\n        const session = await axios(`/api/v1/bookings/checkout-session/${tourID}`);\r\n\r\n        // 2) Create checkout form + charge the credit card\r\n        await stripe.redirectToCheckout({\r\n            sessionId: session.data.session.id\r\n        });\r\n\r\n    } catch(err){\r\n        console.log(err);\r\n        showAlert('error', err);\r\n    }\r\n    \r\n};","import '@babel/polyfill';\r\nimport {displayMap} from './mapbox';\r\nimport {login, logout} from './login';\r\nimport {updateSettings} from './updateSettings';\r\nimport {bookTour} from './stripe';\r\nimport {showAlert} from './alert';\r\n\r\n// DOM ELEMENTS\r\nconst mapBox = document.getElementById('map');\r\nconst loginForm = document.querySelector('.form--login');\r\nconst logOutBtn = document.querySelector('.nav__el--logout');\r\nconst userDataForm = document.querySelector('.form-user-data');\r\nconst userPasswordForm = document.querySelector('.form-user-password');\r\nconst bookBtn = document.getElementById('book-tour');\r\n\r\n// DELEGATION\r\nif(mapBox){\r\n    const locations = JSON.parse(mapBox.dataset.locations);\r\n    displayMap(locations);\r\n}\r\n\r\nif(loginForm){\r\n    loginForm.addEventListener('submit', e => {\r\n        e.preventDefault();\r\n        const email = document.getElementById('email').value;\r\n        const password = document.getElementById('password').value;   \r\n        login(email, password);\r\n    });\r\n}\r\n\r\nif(logOutBtn)   logOutBtn.addEventListener('click', logout);\r\n\r\nif(userDataForm){\r\n    userDataForm.addEventListener('submit', e => {\r\n        e.preventDefault();\r\n        const form = new FormData();\r\n        form.append('name', document.getElementById('name').value);\r\n        form.append('email', document.getElementById('email').value);\r\n        form.append('photo', document.getElementById('photo').files[0]);\r\n        \r\n        updateSettings(form, 'data');\r\n    }); \r\n}\r\n\r\nif(userPasswordForm){\r\n    userPasswordForm.addEventListener('submit', async e => {\r\n        e.preventDefault();\r\n        document.querySelector('.btn--save-password').textContent = 'Updating...';\r\n\r\n        const passwordCurrent = document.getElementById('password-current').value\r\n        const password = document.getElementById('password').value\r\n        const passwordConfirm = document.getElementById('password-confirm').value\r\n        await updateSettings({passwordCurrent, password, passwordConfirm}, 'password');\r\n\r\n        document.querySelector('.btn--save-password').textContent = 'Save password';\r\n        document.getElementById('password-current').value = '';\r\n        document.getElementById('password').value = '';\r\n        document.getElementById('password-confirm').value = '';\r\n    }); \r\n}\r\n\r\nif(bookBtn){\r\n    bookBtn.addEventListener('click', e => {\r\n        e.target.textContent = 'Processing...';\r\n        const {tourId} = e.target.dataset;\r\n        bookTour(tourId);\r\n    });\r\n}\r\n\r\nconst alertMessage = document.querySelector('body').dataset.alert;\r\nif(alertMessage) showAlert('success', alertMessage, 20);"],"names":["$31f182697195f68f$export$4c5dd147b21b9176","locations","mapboxgl","accessToken","map","Map","container","style","scrollZoom","bounds","LngLatBounds","forEach","loc","el","document","createElement","className","Marker","element","anchor","setLngLat","coordinates","addTo","Popup","offset","setHTML","day","description","extend","fitBounds","padding","top","bottom","left","right","$16587cf4a6943845$export$516836c6a9dfc573","querySelector","parentElement","removeChild","$16587cf4a6943845$export$de026b00723010c1","type","message","time","markup","insertAdjacentHTML","window","setTimeout","$e466156f4c41845f$export$596d806903d1f59e","async","email","password","$parcel$interopDefault","$lRq1g$axios","method","url","data","status","location","assign","err","response","$3843a6bc3071435b$export$f558026a994b6051","console","log","toUpperCase","$c6b38b6b1de4b63b$export$8d5bdbf26681c0c2","tourID","stripe","Stripe","session","redirectToCheckout","sessionId","id","$fa79da8abd1c9dd8$var$mapBox","getElementById","$fa79da8abd1c9dd8$var$loginForm","$fa79da8abd1c9dd8$var$logOutBtn","$fa79da8abd1c9dd8$var$userDataForm","$fa79da8abd1c9dd8$var$userPasswordForm","$fa79da8abd1c9dd8$var$bookBtn","JSON","parse","dataset","addEventListener","e","preventDefault","value","form","FormData","append","files","textContent","passwordCurrent","passwordConfirm","target","tourId","$fa79da8abd1c9dd8$var$alertMessage","alert"],"version":3,"file":"index.js.map","sourceRoot":"../../../"}